name: PR-Agent (GPT-5-mini)

on:
    pull_request:
        types: [opened, reopened, ready_for_review, review_requested]
    issue_comment:
        types: [created, edited]

jobs:
    pr_agent_job:
        if: ${{ github.event.sender.type != 'Bot' }}
        runs-on: ubuntu-latest
        permissions:
            issues: write
            pull-requests: write
            contents: write

        steps:
            - name: PR Agent
              uses: qodo-ai/pr-agent@main
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

                  # OpenAI model
                  config.model: 'gpt-5-mini'
                  # Or pin a snapshot for stability:
                  # config.model: "gpt-5.2-2025-12-11"

                  # OpenAI key (PR-Agent expects OPENAI_KEY)
                  OPENAI_KEY: ${{ secrets.OPENAI_API_KEY }}

                  # Optional auto-tools
                  github_action_config.auto_review: 'true'
                  github_action_config.auto_describe: 'true'
                  github_action_config.auto_improve: 'true'
